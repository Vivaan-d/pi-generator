<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>π generator</title>
</head>
<body style="word-wrap: break-word;">
    <b>π =</b>
    <p></p>
    <script>function* piGenerator() {
        let q = 1n, r = 0n, t = 1n, k = 1n, n = 3n, l = 3n;
        while (true) {
          if (4n * q + r - t < n * t) {
            yield n; // Yield the next digit of π
            let nr = 10n * (r - n * t);
            n = (10n * (3n * q + r)) / t - 10n * n;
            q *= 10n;
            r = nr;
          } else {
            let nr = (2n * q + r) * l;
            let nn = (q * (7n * k + 2n) + r * l) / (t * l);
            q *= k;
            t *= l;
            l += 2n;
            k += 1n;
            r = nr;
            n = nn;
          }
        }
      }
      
      const generator = piGenerator();
      let piDigits = "3."; // Initialize with the correct starting sequence
      let skipFirstDigit = true; // Skip the first digit (3) if necessary
      
      setInterval(() => {
  let batch = 100; // Number of digits to generate per interval
  let digits = ""; // Store generated digits in a batch
  while (batch-- > 0) {
    const nextDigit = generator.next().value;
    if (skipFirstDigit) {
      skipFirstDigit = false; // Skip the initial 3
      continue;
    }
    digits += nextDigit;
  }
  piDigits += digits; // Append batch of digits
  document.querySelector("p").innerHTML = piDigits;
}, 10); // Keeps the interval at 10ms
      

    </script>
</body>
</html>
